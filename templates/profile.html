{% extends "base.html" %}

{% block title %}Profile - VibeNotes{% endblock %}

{% block content %}
<div class="profile-container">
		<div class="profile-box">
				<div class="profile-header">
						<div class="avatar-container">
								{% if user.avatar %}
										<img src="{{ url_for('static', filename='avatars/' + user.avatar) }}" alt="{{ user.username }}'s avatar" class="avatar-large">
								{% else %}
										<div class="avatar-placeholder">{{ user.username[0].upper() }}</div>
								{% endif %}
						</div>
						<h2>{{ user.username }}</h2>
				</div>
				
				<div class="profile-content">
						{% if is_own_profile %}
								<h3>Edit Your Profile</h3>
								<form method="POST" action="{{ url_for('profile') }}" enctype="multipart/form-data" class="profile-form">
										<div class="form-group">
												<label for="description">Description</label>
												<textarea id="description" name="description" rows="4" placeholder="Tell us about yourself...">{{ user.description or '' }}</textarea>
												<small>Share a bit about yourself with other users</small>
										</div>
										
										<div class="form-group">
												<label for="avatar">Upload Avatar</label>
												<input type="file" id="avatar" name="avatar" accept="image/png, image/jpeg, image/jpg, image/gif">
												<small>Allowed formats: PNG, JPG, JPEG, GIF (Max 5MB)</small>
										</div>
										
										<div class="form-actions">
												<button type="submit" class="btn btn-primary">Update Profile</button>
												<a href="{{ url_for('index') }}" class="btn btn-secondary">Cancel</a>
										</div>
								</form>
						{% else %}
								<div class="profile-view">
										<h3>About {{ user.username }}</h3>
										{% if user.description %}
												<p class="user-description">{{ user.description }}</p>
										{% else %}
												<p class="user-description no-description">This user hasn't added a description yet.</p>
										{% endif %}
								</div>
								<div class="form-actions">
										<a href="{{ url_for('users') }}" class="btn btn-secondary">Back to Users</a>
								</div>
						{% endif %}
				</div>
		</div>
		
		{% if public_notes %}
		<div class="profile-box public-notes-section">
				<h3>Public Notes</h3>
				<p class="public-notes-subtitle">{{ "Your" if is_own_profile else user.username + "'s" }} public notes visible to all users</p>
				<div class="public-notes-grid">
						{% for note in public_notes %}
								<div class="public-note-card">
										<a href="{{ url_for('view_note', note_id=note.id) }}" class="public-note-link">
												<h4>{{ note.title }}</h4>
												{% if note.content %}
														<p class="public-note-preview">{{ note.content[:120] }}{% if note.content|length > 120 %}...{% endif %}</p>
												{% else %}
														<p class="public-note-preview empty">No content</p>
												{% endif %}
												<span class="public-note-date">{{ note.created_at.strftime('%b %d, %Y') }}</span>
										</a>
								</div>
						{% endfor %}
				</div>
		</div>
		{% elif is_own_profile %}
		<div class="profile-box public-notes-section">
				<h3>Public Notes</h3>
				<p class="public-notes-subtitle">You haven't made any notes public yet. Create or edit a note and check "Make this note public" to share it on your profile.</p>
		</div>
		{% endif %}
</div>
{% endblock %}

